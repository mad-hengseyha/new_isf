var gf_money=fx.noConflict();function gformAddCurrencyFieldAction(r,e,c){var n,o,_,f=jQuery("#input_"+e+"_"+gf_currency.currency_field_id);0<f.length&&(_=!1,void 0!==(n=f.parents(".gform_page").attr("id"))&&0<n.length?(o=(n=n.split("_"))[3],_=!0):o=c,o==c&&(f.on("change",{form_id:e},gformStartUpdateCurrency),gform.addFilter("gform_merge_tag_value_pre_calculation","gform_merge_tag_value_pre_calculation_currency"),gform.addFilter("gform_product_total","gform_product_total_currency"),gf_currency.converted_calc_fields=new Array,gf_currency.converted_calc_fields[e]=new Array,gf_currency.calc_field_base_price_converted=!1,c=jQuery("#gform_wrapper_"+e),c=jQuery("#gform_confirmation_wrapper_"+e).hasClass("gform_validation_error")||c.hasClass("gform_validation_error"),(0==gformCurrencyIsPostback(e)&&!_||_&&!c)&&(gf_global.gf_currency_config.code=gf_currency.default_from,gf_global.default_currency_config=gf_global.gf_currency_config,0<(c=f.hasClass("gfield_radio")?f.find('input[type="radio"]:checked')[0].value:jQuery(this).val()).length&&gf_global.default_currency_config.code!==c&&f.trigger("change"))))}function gformStartUpdateCurrency(r){jQuery(this).prop("disabled",!0),gformAllProductFields("disable"),gformSubmitButtons("disable"),gf_currency.converted_calc_fields=new Array,gf_currency.converted_calc_fields[r.data.form_id]=new Array,jQuery(this).after('<img id="gform_ajax_spinner_currency_field"  class="gform_ajax_spinner" src="'+gf_currency.spinner_url+'" alt="" />'),gformIsMultiPage(r.data.form_id)&&jQuery(".ginput_total_"+r.data.form_id).after('<img id="gform_ajax_spinner_total_field"  class="gform_ajax_spinner" src="'+gf_currency.spinner_url+'" alt="" />');var e=jQuery(this);gformGetCurrency(e.hasClass("gfield_radio")?e.find('input[type="radio"]:checked')[0].value:jQuery(this).val(),r.data.form_id,this)}function gformAllProductFields(r){jQuery(".gfield_price").each(function(){"disable"==r?(jQuery(this).find('input[type="text"], input[type="number"], select').prop("disabled",!0),jQuery(this).find('input[type="radio"], input[type="checkbox"]').prop("disabled",!0)):"enable"==r&&(jQuery(this).find('input[type="text"], input[type="number"], select').prop("disabled",!1),jQuery(this).find('input[type="radio"], input[type="checkbox"]').prop("disabled",!1))})}function gformSubmitButtons(r){"disable"==r?(jQuery(".gform_next_button").prop("disabled",!0),jQuery(".gform_previous_button").prop("disabled",!0),jQuery(".gform_button").prop("disabled",!0)):"enable"==r&&(jQuery(".gform_next_button").prop("disabled",!1),jQuery(".gform_previous_button").prop("disabled",!1),jQuery(".gform_button").prop("disabled",!1))}function gformGetCurrency(r,e,c){var n,r={action:"gfp_currency_selector_get_currency",gfp_currency_selector_get_currency:gf_currency.nonce,currency:r};jQuery.post(gf_currency.ajaxurl,r,function(r){!0===r.success&&(n=r.data)&&0!==n.length&&(gformFinishUpdateCurrency(n,e),jQuery(c).prop("disabled",!1),gformAllProductFields("enable"),gformSubmitButtons("enable")),jQuery("#gform_ajax_spinner_currency_field").remove(),jQuery("#gform_ajax_spinner_total_field").remove()})}function gformFinishUpdateCurrency(r,e){if(gf_global.gf_currency_config.code!==r.code){gf_global.prev_currency_config=gf_global.gf_currency_config,gf_currency.currency_config=r;for(var c=0;c<_gformPriceFields[e].length;c++){var n=_gformPriceFields[e][c];gformChangePriceDisplay(e,n),jQuery("#field_"+e+"_"+n).hasClass("gfield_calculation")&&gformChangeCalcFieldBasePrice(jQuery("#ginput_base_price_"+e+"_"+n))}for(e in gf_currency.calc_field_base_price_converted=!1,gf_global.gf_currency_config=r,_gformPriceFields)_gformPriceFields.hasOwnProperty(e)&&gformCalculateTotalPrice(e)}}function gformChangePriceDisplay(c,n){var o,r="_"+c+"_"+n,e="text",_=jQuery(".gfield_product"+r).find("input.ginput_amount"),f=jQuery(".gfield_product"+r).find("input.ginput_product_price");0<_.length||0<f.length?(e="val",0<_.length?gformUpdatePriceDisplay(e,_):gformUpdatePriceDisplay(e,f,{readonly:!0,suffix:r})):0<(_=jQuery(".gfield_product"+r).find("span.ginput_product_price")).length?gformUpdatePriceDisplay(e,_):0<(_=jQuery(".gfield_option"+r+", .gfield_shipping_"+c).find("span.ginput_price")).length?_.each(function(){var r,e=jQuery(this).text(),c=(e=e.trim()).charAt(0);"+"==c||"-"==c?(r=c,r+=gformCurrencyConvertPrice(e=e.replace(c,""))):r=gformCurrencyConvertPrice(e),jQuery(this).text(r)}):0<(_=jQuery(".gfield_option"+r+", .gfield_shipping_"+c).find("select")).length?(o=gformCurrencyGetPrice(_.val()),o=gf_money(o).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code),_.children("option").each(function(){var r=jQuery(this),e=gformCurrencyGetOptionLabel(r,r.val(),o,c,n);r.html(e)})):0<(_=jQuery(".gfield_shipping_"+c).find("span.ginput_shipping_price")).length&&gformUpdatePriceDisplay(e,_)}function gformUpdatePriceDisplay(r,e,c=null){var n;"val"===r?(n=gformCurrencyConvertPrice(e.val()),null!=c&&!0===c.readonly?(e.hide(),(r=jQuery("#add_disabled_product_field_price"+c.suffix)).length?(n=gformCurrencyConvertPrice(r.text()),r.text(n)):e.after('<span id="add_disabled_product_field_price'+c.suffix+'">'+n+"</span>")):e.val(n)):(n=gformCurrencyConvertPrice(e.text()),e.text(n))}function gformChangeCalcFieldBasePrice(r){var e;gf_currency.calc_field_base_price_converted&&0<r.length&&(e=r.val(),e=new Currency(gf_global.prev_currency_config).toNumber(e),e=gf_money(e=!1===e?0:e).from(gf_global.prev_currency_config.code).to(gf_global.default_currency_config.code),e=0===gf_global.default_currency_config.decimals?Math.round(e):Math.round(100*e)/100,gf_global.gf_currency_config=gf_global.default_currency_config,e=gformFormatMoney(e||0,!0),gf_global.gf_currency_config=gf_global.prev_currency_config,r.val(e))}function gformCurrencyGetPrice(r){var e=r.split("|"),r=new Currency(gf_global.default_currency_config);return 1<e.length&&!1!==r.toNumber(e[1])?r.toNumber(e[1]):0}function gformCurrencyConvertPrice(r){var e=gformCurrencyToNumber(r,gf_global.gf_currency_config),e=gf_money(e).from(gf_global.gf_currency_config.code).to(gf_currency.currency_config.code);return gf_global.gf_currency_config=gf_currency.currency_config,r=gformFormatMoney(e,!0),gf_global.gf_currency_config=gf_global.prev_currency_config,r}function gformCurrencyToNumber(r,e){return gformIsNumber(r)?parseFloat(r):gformCurrencyCleanNumber(r,e.symbol_right,e.symbol_left,e.decimal_separator)}function gformCurrencyCleanNumber(r,e,c,n){r=(r=(r=(r+=" ").replace(/&.*?;/,"",r)).replace(e,"")).replace(c,"");for(var o="",_=!1,f=0;f<r.length;f++){var t=r.substr(f,1);0<=parseInt(t)&&parseInt(t)<=9||t==n&&(gformIsNumber(r.substr(f+1,1))||gformIsNumber(r.substr(f-1,1)))?o+=t:"-"==t&&(_=!0)}for(var i="",f=0;f<o.length;f++){var g=o.substr(f,1);"0"<=g&&g<="9"?i+=g:g==n&&(i+=".")}return _&&(i="-"+i),!!gformIsNumber(i)&&parseFloat(i)}function gformIsMultiPage(r){var e=!1,c=jQuery("#gform_target_page_number_"+r).val(),r=jQuery("#gform_source_page_number_"+r).val();return 0==c&&1==r||(e=!0),e}function gformCurrencyIsPostback(r){var e=!1,r=jQuery("#gform_ajax_frame_"+r).contents().find("*").html();return void 0!==r&&(e=0<r.indexOf("GF_AJAX_POSTBACK")||void 0!==gf_currency.is_postback),e}function gformCurrencyGetOptionLabel(r,e,c,n,o){r=jQuery(r);var _=gformCurrencyGetPrice(e),_=gf_money(_).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code),f=r.attr("price"),e=r.html().replace(/<span(.*)<\/span>/i,"").replace(f,"");gf_global.gf_currency_config=gf_currency.currency_config;f=gformGetPriceDifference(c,_),f=0==gformToNumber(f)?"":" "+f,r="option"==r[0].tagName.toLowerCase()?" "+f:"<span class='ginput_price'>"+f+"</span>",f=e+r;return window.gform_format_option_label&&(f=gform_format_option_label(f,e,r,c,_,n,o)),gf_global.gf_currency_config=gf_global.prev_currency_config,f}function gform_merge_tag_value_pre_calculation_currency(r,e,c,n,o){if("0"!==o&&void 0!==gf_currency.currency_config&&c){c=o,o=e[1],e=parseInt(o),o=gf_get_field_number_format(e,c);if(!o)return r;o=gformGetDecimalSeparator(o);0<jQuery(".gfield_product"+("_"+c+"_"+e)+" .ginput_amount").length?(","==o&&","!==gf_currency.currency_config.decimal_separator||"."==o&&"."!==gf_currency.currency_config.decimal_separator)&&(r=r.replace(gf_currency.currency_config.decimal_separator,o)):(r=gformCurrencyToNumber(r,gf_global.default_currency_config),converted_value=gf_money(r).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code),converted_value=0===gf_currency.currency_config.decimals?Math.round(converted_value):Math.round(100*converted_value)/100,r=converted_value,-1==gf_currency.converted_calc_fields[c].indexOf(n.field_id)&&(gf_currency.converted_calc_fields[c].push(n.field_id),gf_currency.calc_field_base_price_converted=!0))}return r}function gform_product_total_currency(r,e){if("0"!==e&&void 0!==gf_currency.currency_config&&(void 0===window["gf_submitting_"+e]||0==window["gf_submitting_"+e])){gf_global.gf_currency_config=gf_global.default_currency_config;var c=0,n=0;_anyProductSelected=!1;for(var o,_=0;_<_gformPriceFields[e].length;_++){var f=e,t=_gformPriceFields[e][_];gformCurrencyUpdateLabel(f,t);var i,g="_"+f+"_"+t,u=jQuery(".gfield_product"+g+" .ginput_amount");0<u.length?(i=u.val(),gformIsHidden(u)&&(i=0),n=!1===(i=new Currency(gf_currency.currency_config).toNumber(i))?0:i):jQuery("#field_"+f+"_"+t).hasClass("gfield_calculation")&&-1!=gf_currency.converted_calc_fields[f].indexOf(parseInt(t))?0<(i=jQuery("#ginput_base_price"+g)).length&&(i=i.val(),i=new Currency(gf_currency.currency_config).toNumber(i),n=!1===i?0:i):n=gf_money(gformGetBasePrice(f,t)).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code);t=gformGetProductQuantity(f,t);0<t&&(jQuery(".gfield_option"+g).find("input:checked, select").each(function(){gformIsHidden(jQuery(this))||(n+=gf_money(gformGetPrice(jQuery(this).val())).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code))}),_anyProductSelected=!0),n*=t,c+=n=Math.round(100*n)/100,n=0}_anyProductSelected&&(o=gformGetShippingPrice(e),c+=gf_money(o).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code)),r=0===gf_currency.currency_config.decimals?Math.round(c):Math.round(100*c)/100,gf_global.gf_currency_config=gf_currency.currency_config}return r}function gformCurrencyUpdateLabel(o,r){var e="_"+o+"_"+r;!gformCurrencyIsPostback(o)||0<(r=jQuery("#ginput_base_price"+e)).length&&(r=r.val(),r=new Currency(gf_global.gf_currency_config).toNumber(r),r=gf_money(r=!1===r?0:r).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code),gf_global.gf_currency_config=gf_currency.currency_config,jQuery(".gfield_product"+e).find("span.ginput_product_price").text(gformFormatMoney(r,!0)),gf_global.gf_currency_config=gf_global.default_currency_config),jQuery(".gfield_option"+e+", .gfield_shipping_"+o).find("select").each(function(){var r=jQuery(this),c=gformGetPrice(r.val()),c=gf_money(c).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code),n=r.attr("id").split("_")[2];r.children("option").each(function(){var r=jQuery(this),e=gform_product_total_currency_GetOptionLabel(r,r.val(),c,o,n);r.html(e)})}),jQuery(".gfield_option"+e).find(".gfield_checkbox").find("input").each(function(){var r=jQuery(this),e=r.attr("id"),c=e.split("_")[2],e=e.replace("choice_","#label_"),e=jQuery(e),c=gform_product_total_currency_GetOptionLabel(e,r.val(),0,o,c);e.html(c)}),jQuery(".gfield_option"+e+", .gfield_shipping_"+o).find(".gfield_radio").each(function(){var c=0,r=jQuery(this),n=r.attr("id").split("_")[2],r=r.find("input:checked").val();r&&(c=gformGetPrice(r),c=gf_money(c).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code)),jQuery(this).find("input").each(function(){var r=jQuery(this),e=r.attr("id").replace("choice_","#label_"),e=jQuery(e),r=gform_product_total_currency_GetOptionLabel(e,r.val(),c,o,n);e.html(r)})})}function gform_product_total_currency_GetOptionLabel(r,e,c,n,o){r=jQuery(r);var _=gformGetPrice(e),_=gf_money(_).from(gf_global.default_currency_config.code).to(gf_currency.currency_config.code),f=r.attr("price"),e=r.html().replace(/<span(.*)<\/span>/i,"").replace(f,"");gf_global.gf_currency_config=gf_currency.currency_config;f=gformGetPriceDifference(c,_),f=0==gformToNumber(f)?"":" "+f;r.attr("price",f),gf_global.gf_currency_config=gf_global.default_currency_config;r="option"==r[0].tagName.toLowerCase()?" "+f:"<span class='ginput_price'>"+f+"</span>",f=e+r;return window.gform_format_option_label&&(f=gform_format_option_label(f,e,r,c,_,n,o)),f}gf_money.base=gf_currency.base,gf_money.rates=gf_currency.rates,jQuery(document).on("gform_post_render",gformAddCurrencyFieldAction);